{"version":3,"file":"documentsApi-b895ecfe.js","sources":["../../src/shared/api/documentsApi.ts"],"sourcesContent":["const API_BASE_URL = 'http://localhost:5000/api';\r\n\r\nexport interface Document {\r\n  id: number;\r\n  title: string;\r\n  description: string;\r\n  category?: string;\r\n  fileUrl?: string;\r\n  fileName?: string;\r\n  fileSize?: string;\r\n  uploadDate: string;\r\n  lastUpdate: string;\r\n  expiryDate?: string;\r\n  status?: 'active' | 'expired' | 'not_required';\r\n}\r\n\r\nexport interface DocumentsData {\r\n  charter: Document[];\r\n  license: Document[];\r\n  accreditation: Document[];\r\n  regulations: Document[];\r\n  reports: Document[];\r\n  collective: Document[];\r\n  prescriptions: Document[];\r\n  lastUpdated: string;\r\n  [key: string]: Document[] | string;\r\n}\r\n\r\nexport interface DocumentsResponse {\r\n  status: string;\r\n  data: DocumentsData;\r\n}\r\n\r\nexport const documentsApi = {\r\n  // Получить все документы\r\n  getDocuments: async (): Promise<DocumentsResponse> => {\r\n    try {\r\n      const response = await fetch(`${API_BASE_URL}/documents`);\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP error! status: ${response.status}`);\r\n      }\r\n      return await response.json();\r\n    } catch (error) {\r\n      console.error('Ошибка при загрузке документов:', error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  // Создать новый документ\r\n  createDocument: async (documentData: {\r\n    title: string;\r\n    description: string;\r\n    category: string;\r\n    status?: string;\r\n    expiryDate?: string;\r\n    file?: File;\r\n  }) => {\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append('title', documentData.title);\r\n      formData.append('description', documentData.description);\r\n      formData.append('category', documentData.category);\r\n      if (documentData.status) formData.append('status', documentData.status);\r\n      if (documentData.expiryDate) formData.append('expiryDate', documentData.expiryDate);\r\n      if (documentData.file) formData.append('file', documentData.file);\r\n\r\n      const response = await fetch(`${API_BASE_URL}/documents`, {\r\n        method: 'POST',\r\n        body: formData,\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json();\r\n        throw new Error(errorData.message || `HTTP error! status: ${response.status}`);\r\n      }\r\n\r\n      return await response.json();\r\n    } catch (error) {\r\n      console.error('Ошибка при создании документа:', error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  // Обновить документ\r\n  updateDocument: async (id: number, documentData: {\r\n    title?: string;\r\n    description?: string;\r\n    category?: string;\r\n    status?: string;\r\n    expiryDate?: string;\r\n    file?: File;\r\n  }) => {\r\n    try {\r\n      const formData = new FormData();\r\n      if (documentData.title) formData.append('title', documentData.title);\r\n      if (documentData.description) formData.append('description', documentData.description);\r\n      if (documentData.category) formData.append('category', documentData.category);\r\n      if (documentData.status) formData.append('status', documentData.status);\r\n      if (documentData.expiryDate !== undefined) formData.append('expiryDate', documentData.expiryDate);\r\n      if (documentData.file) formData.append('file', documentData.file);\r\n\r\n      const response = await fetch(`${API_BASE_URL}/documents/${id}`, {\r\n        method: 'PUT',\r\n        body: formData,\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json();\r\n        throw new Error(errorData.message || `HTTP error! status: ${response.status}`);\r\n      }\r\n\r\n      return await response.json();\r\n    } catch (error) {\r\n      console.error('Ошибка при обновлении документа:', error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  // Удалить документ\r\n  deleteDocument: async (id: number) => {\r\n    try {\r\n      const response = await fetch(`${API_BASE_URL}/documents/${id}`, {\r\n        method: 'DELETE',\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json();\r\n        throw new Error(errorData.message || `HTTP error! status: ${response.status}`);\r\n      }\r\n\r\n      return await response.json();\r\n    } catch (error) {\r\n      console.error('Ошибка при удалении документа:', error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  // Скачать документ\r\n  downloadDocument: (fileUrl: string, fileName: string) => {\r\n    const link = document.createElement('a');\r\n    // Добавляем базовый URL сервера если fileUrl относительный\r\n    const fullUrl = fileUrl.startsWith('http') ? fileUrl : `http://localhost:5000${fileUrl}`;\r\n    link.href = fullUrl;\r\n    link.download = fileName;\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    document.body.removeChild(link);\r\n  },\r\n\r\n  // Просмотреть документ\r\n  viewDocument: (fileUrl: string) => {\r\n    // Добавляем базовый URL сервера если fileUrl относительный\r\n    const fullUrl = fileUrl.startsWith('http') ? fileUrl : `http://localhost:5000${fileUrl}`;\r\n    window.open(fullUrl, '_blank');\r\n  }\r\n}; "],"names":["API_BASE_URL","documentsApi","response","error","documentData","formData","errorData","id","fileUrl","fileName","link","fullUrl"],"mappings":"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"}